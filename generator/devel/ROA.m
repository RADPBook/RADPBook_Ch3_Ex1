% %ROA.m
% 
clear all
close all
clc
%[x1,x2,z]=meshgrid([-1:0.1:1],[-.5:0.1:.5],[-2.5:0.25:2.5]);
[x1,x2]=meshgrid([-2.2:0.1:2.2],[-2.6:0.1:2.6]);
%[x1,z]=meshgrid([-1:0.1:1],[-2.5:0.25:2.5]);
z=0;
v= 3.4086.*x1.*x1 + 0.0272.*x2.*x2 + 0.1400.*x1.*x2+1/2.*([-z-2.6962.*x1-1.0353.*x2-0.0427.*x1.*x2]).^2 ;

%z=exp(-x.^2-y.^2);
C=contour(x1,x2,v,1.3,'color',[0,0,1],'Linewidth',2);
%clabel(C);
title('Invariant set on the (\delta,w)- plane')
xlabel('x_1:=\delta-\delta_0')
ylabel('x_2:=w')
hold on

z0=x1.^2+0.5*x2.^2;
contour(x1,x2,z0,3.1,'color',[0,0,1],'Linewidth',2);
hold off

text(1,1.8,'\Omega_{1,0}','Fontsize',16)
text(0.3,0,'\Omega_{1,9*}','Fontsize',16)

%%
figure(2)
w1=[    3.5124
    0.0266
    0.1307
   -0.3966
   -0.0001
    0.0115
    0.0005
    0.4834
    0.0000
    0.0156
    0.0002
    0.0002];
w11=[63.3909
    0.9350
    0.1699
  -13.4808
    0.0000
    0.0068
    0.0055
   -0.3630
    0.0005
    0.1023
    0.0014
    0.0565];
z2= w1(1).*x1.^2 ...
    +w1(2).*x2.^2 ...
    +w1(3).*x1.*x2 ...
    +w1(4).*x1.*x1.*x1 ...
    +w1(5).*x2.*x2.*x2 ...
    +w1(6).*x1.*x1.*x2 ...
    +w1(7).*x1.*x2.*x2 ...
    +w1(8).*x1.*x1.*x1.*x1 ...
    +w1(9).*x2.*x2.*x2.*x2 ...
    +w1(10).*x1.*x1.*x1.*x2 ...
    +w1(11).*x2.*x2.*x2.*x1 ...
    +w1(12).*x1.*x1.*x2.*x2;
z3= w11(1).*x1.^2 ...
    +w11(2).*x2.^2 ...
    +w11(3).*x1.*x2 ...
    +w11(4).*x1.*x1.*x1 ...
    +w11(5).*x2.*x2.*x2 ...
    +w11(6).*x1.*x1.*x2 ...
    +w11(7).*x1.*x2.*x2 ...
    +w11(8).*x1.*x1.*x1.*x1 ...
    +w11(9).*x2.*x2.*x2.*x2 ...
    +w11(10).*x1.*x1.*x1.*x2 ...
    +w11(11).*x2.*x2.*x2.*x1 ...
    +w11(12).*x1.*x1.*x2.*x2;

surf(x1,x2,z2)
hold on
surf(x1,x2,z3)
hold off
title('V_9')
xlabel('\delta-\delta_0')
ylabel('w')
